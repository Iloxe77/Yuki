<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Moje Prompty do ChatGPT</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    textarea, input[type="text"] {
      width: 100%;
      margin-bottom: 10px;
    }
    button {
      margin-top: 5px;
    }
    .prompt-entry {
      margin-bottom: 10px;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    .response {
      background-color: #f5f5f5;
      padding: 10px;
      margin-top: 10px;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <h1>Moje Prompty do ChatGPT</h1>

  <h2>Dodaj nowy prompt</h2>
  <input type="text" id="promptTitle" placeholder="Tytuł prompta">
  <textarea id="promptText" rows="4" placeholder="Treść prompta"></textarea>
  <button onclick="addPrompt()">Zapisz prompt</button>

  <h2>Lista zapisanych promptów</h2>
  <div id="promptList"></div>

  <div id="chatResponse" class="response"></div>

  <script>
    const promptListDiv = document.getElementById('promptList');
    const responseDiv = document.getElementById('chatResponse');

    function getPrompts() {
      return JSON.parse(localStorage.getItem('prompts') || '[]');
    }

    function savePrompts(prompts) {
      localStorage.setItem('prompts', JSON.stringify(prompts));
    }

    function addPrompt() {
      const title = document.getElementById('promptTitle').value.trim();
      const text = document.getElementById('promptText').value.trim();
      if (!title || !text) return;

      const prompts = getPrompts();
      prompts.push({ title, text });
      savePrompts(prompts);
      document.getElementById('promptTitle').value = '';
      document.getElementById('promptText').value = '';
      renderPrompts();
    }

    function deletePrompt(index) {
      const prompts = getPrompts();
      prompts.splice(index, 1);
      savePrompts(prompts);
      renderPrompts();
    }

    async function sendToChatGPT(prompt) {
      const apiKey = prompt('Wklej swój klucz API OpenAI:');
      if (!apiKey) return;

      const body = {
        model: "gpt-3.5-turbo",
        messages: [
          { role: "user", content: prompt }
        ]
      };

      const response = await fetch("https://api.openai.com/v1/chat/completions", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Authorization": `Bearer ${apiKey}`
        },
        body: JSON.stringify(body)
      });

      const data = await response.json();
      const reply = data.choices?.[0]?.message?.content || 'Brak odpowiedzi';
      responseDiv.textContent = reply;
    }

    function renderPrompts() {
      const prompts = getPrompts();
      promptListDiv.innerHTML = '';

      prompts.forEach((prompt, index) => {
        const div = document.createElement('div');
        div.className = 'prompt-entry';
        div.innerHTML = `
          <strong>${prompt.title}</strong><br>
          <pre>${prompt.text}</pre>
          <button onclick="sendToChatGPT(\`${prompt.text.replace(/`/g, '\\`')}\`)">Wyślij do ChatGPT</button>
          <button onclick="deletePrompt(${index})">Usuń</button>
        `;
        promptListDiv.appendChild(div);
      });
    }

    renderPrompts();
  </script>
</body>
</html>
